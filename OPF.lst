GAMS 24.5.3  r54322 Released Oct  1, 2015 WEX-WEI x86 64bit/MS Windows 10/21/15 11:06:47 Page 1
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


   1  Sets
   2  i
   3  ij   (i,i)      lines
   4  CCs  (i,i)      constant current sources
   5  CCl  (i,i)      constant current loads
   6   
   7  ;
   8   
   9  Alias
  10  (i,j)
  11  ;
  12   
  13  * ------------------------------------------------------------------------
      -----
  14  * DATA IMPORT FROM EXCEL FILE *
  15   
  16   
  17  Sets
INCLUDE    C:\Users\robin\Google Drive\TU Delft\Thesis\GAMS\projdir\Indices_OPF.
           inc
  19  * -----------------------------------------------------
  20  * XLS2GMS 2.8      24.5.3 r54322 Released Oct  1, 2015 VS8 x86 32bit/MS Wi
      ndows
  21  * Erwin Kalvelagen, GAMS Development Corp.
  22  * -----------------------------------------------------
  23  * Application: Microsoft Excel
  24  * Version:     16.0
  25  * Workbook:    C:\Users\robin\Google Drive\TU Delft\Thesis\GAMS\projdir\Op
      timal Power Flow\Input_Data_OPF.xls
  26  * Sheet:       Indices_Sheet(Sheet1)
  27  * Range:       $C$4:$H$10
  28  * -----------------------------------------------------
  29  * Indices
  30  i         /    n1   *    n6   /
  31   
  32   
  33   
  34   
  35   
  36  * -----------------------------------------------------
  37  ;
  38   
  39  table Rmap(i,j,*)
INCLUDE    C:\Users\robin\Google Drive\TU Delft\Thesis\GAMS\projdir\Resistive_Ne
           twork_OPF.inc
  41  * -----------------------------------------------------
  42  * XLS2GMS 2.8      24.5.3 r54322 Released Oct  1, 2015 VS8 x86 32bit/MS Wi
      ndows
  43  * Erwin Kalvelagen, GAMS Development Corp.
  44  * -----------------------------------------------------
  45  * Application: Microsoft Excel
  46  * Version:     16.0
  47  * Workbook:    C:\Users\robin\Google Drive\TU Delft\Thesis\GAMS\projdir\Op
      timal Power Flow\Input_Data_OPF.xls
  48  * Sheet:       Circuit_Data(Sheet2)
  49  * Range:       $B$4:$E$35
  50  * -----------------------------------------------------
  51          Rline
  52  n4.n5   1
  53  n5.n6   1
  54  n6.n4   1
  55   
  56   
  57   
  58   
  59   
  60   
  61   
  62   
  63   
  64   
  65   
  66   
  67  n5.n4   1
  68  n6.n5   1
  69  n4.n6   1
  70   
  71   
  72   
  73   
  74   
  75   
  76   
  77   
  78   
  79   
  80   
  81   
  82   
  83  * -----------------------------------------------------
  84  ;
  85   
  86  table CCsourcesmap(i,j,*)
INCLUDE    C:\Users\robin\Google Drive\TU Delft\Thesis\GAMS\projdir\CCsources_OP
           F.inc
  88  * -----------------------------------------------------
  89  * XLS2GMS 2.8      24.5.3 r54322 Released Oct  1, 2015 VS8 x86 32bit/MS Wi
      ndows
  90  * Erwin Kalvelagen, GAMS Development Corp.
  91  * -----------------------------------------------------
  92  * Application: Microsoft Excel
  93  * Version:     16.0
  94  * Workbook:    C:\Users\robin\Google Drive\TU Delft\Thesis\GAMS\projdir\Op
      timal Power Flow\Input_Data_OPF.xls
  95  * Sheet:       Circuit_Data(Sheet2)
  96  * Range:       $G$4:$M$35
  97  * -----------------------------------------------------
  98          CCSmap CCScost CCSmax CCSmin
  99  n4.n1   4      1       9      -9
 100  n6.n2   7      6       9      -9
 101   
 102   
 103   
 104   
 105   
 106   
 107   
 108   
 109   
 110   
 111   
 112   
 113   
 114  n1.n4   -4
 115  n2.n6   -7
 116   
 117   
 118   
 119   
 120   
 121   
 122   
 123   
 124   
 125   
 126   
 127   
 128   
 129   
 130  * -----------------------------------------------------
 131  ;
 132   
 133  table CCloadsmap(i,j,*)
INCLUDE    C:\Users\robin\Google Drive\TU Delft\Thesis\GAMS\projdir\CCloads_OPF.
           inc
 135  * -----------------------------------------------------
 136  * XLS2GMS 2.8      24.5.3 r54322 Released Oct  1, 2015 VS8 x86 32bit/MS Wi
      ndows
 137  * Erwin Kalvelagen, GAMS Development Corp.
 138  * -----------------------------------------------------
 139  * Application: Microsoft Excel
 140  * Version:     16.0
 141  * Workbook:    C:\Users\robin\Google Drive\TU Delft\Thesis\GAMS\projdir\Op
      timal Power Flow\Input_Data_OPF.xls
 142  * Sheet:       Circuit_Data(Sheet2)
 143  * Range:       $O$4:$R$35
 144  * -----------------------------------------------------
 145          CCLmap
 146  n3.n5   5
 147   
 148   
 149   
 150   
 151   
 152   
 153   
 154   
 155   
 156   
 157   
 158   
 159   
 160   
 161  n5.n3   -5
 162   
 163   
 164   
 165   
 166   
 167   
 168   
 169   
 170   
 171   
 172   
 173   
 174   
 175   
 176   
 177  * -----------------------------------------------------
 178  ;
 179   
 180  * ------------------------------------------------------------------------
      -----
 181  * PARAMETER DEFINITION
 182   
 183  Parameters
 184   
 185  R          (i,j)
 186  CCSref     (i,j)
 187  CCScost    (i,j)
 188  CCSmax     (i,j)
 189  CCSmin     (i,j)
 190  CCLoads    (i,j)
 191  Sources
 192  ;
 193   
 194  R        (i,j)  =  Rmap(i,j,'Rline')           ;
 195  CCSref   (i,j)  =  CCsourcesmap(i,j,'CCSmap')  ;
 196  CCScost  (i,j)  =  CCsourcesmap(i,j,'CCScost') ;
 197  CCSmax   (i,j)  =  CCsourcesmap(i,j,'CCSmax')  ;
 198  CCSmin   (i,j)  =  CCsourcesmap(i,j,'CCSmin')  ;
 199  CCLoads  (i,j)  =  CCloadsmap(i,j,'CCLmap')    ;
 200   
 201   
 202   
 203  Scalar
 204  Vnom       /47.5/
 205  ;
 206   
 207  * ------------------------------------------------------------------------
      -----
 208  * DYNAMIC SET OF INDICES
 209   
 210  ij    (i,j)    $[R(i,j)]            = yes;
 211  CCs   (i,j)    $[CCSref(i,j)]       = yes;
 212  CCl   (i,j)    $[CCLoads(i,j)]      = yes;
 213   
 214  Sources  = sum[(i,j), CCSref(i,j)];
 215  * ------------------------------------------------------------------------
      -----
 216  * VARIABLE DEFINITION
 217   
 218  Variables
 219  Ibr       (i,j)         'Branch Current'
 220  In        (i)           'Nodal Current'
 221  V         (i)           'Nodal Voltage'
 222  CCSources (i,j)         'Constant Current Source'
 223  cost
 224   
 225   
 226  * ------------------------------------------------------------------------
      -----
 227  * POWER FLOW EQUATIONS
 228   
 229  Equations
 230   
 231  AllCurrentSources (i)     'Sum of currents of all sources at node i'
 232  BranchCurrent     (i,j)   'Current in branch ij'
 233  NodalCurrent      (i)     'Nodal current equation'
 234   
 235  Equality
 236  Costfunction              'Cost function to be minimized'
 237  ;
 238   
 239  * ------------------------------------------------------------------------
      -----
 240  * Set Voltage limits and fixed nodal voltages
 241  V.lo(i)     =   -200;
 242  V.up(i)     =    200;
 243  V.fx('n1')  =    0;
 244   
 245  *CCSources.lo (i,j) = CCSmin;
 246  *CCSources.up (i,j) = CCSmax;
 247   
 248  CCSources.lo (i,j) = -9;
 249  CCSources.up (i,j) = 9;
 250   
 251   
 252   
 253  * ------------------------------------------------------------------------
      -----
 254  * Circuit Equation
 255   
 256  BranchCurrent     (ij(i,j)) .. Ibr(i,j) =e=  (R(i,j)*(V(i)-V(j)));
 257  NodalCurrent      (i)       .. In(i)    =e=  sum[j $ij(i,j)   ,Ibr(i,j)] -
       sum[j $ij(j,i), Ibr(j,i)];
 258  AllCurrentSources (i)       .. In(i)    =e=  sum[j $CCs(i,j)  ,CCSources(i
      ,j)] + sum[j $CCl(i,j)  ,CCLoads(i,j)];
 259   
 260   
 261   
 262  * ------------------------------------------------------------------------
      -----
 263  * OPTIMAL POWER FLOW EQUATIONS
 264   
 265  Equality                    ..  sum[(i,j) $CCs(i,j), CCSources(i,j)] =e= s
      um[(i,j) $CCl(i,j), CCLoads(i,j)];
 266  Costfunction                ..  cost    =e=  sum[(i,j) $CCs(i,j), CCSource
      s(i,j)*CCScost(i,j)];
 267   
 268  model OPF /all/;
 269   
 270  solve OPF minimizing cost using lp;
 271   
 272  Display
 273  R,
 274  V.l,
 275  ij,
 276  CCs,
 277  CCl,
 278  In.l,
 279  Ibr.l,
 280  CCSources.l,
 281  cost.l
 282  ;
 283   
 284   
 285   
 286   
 287   
 288   
 289   
GAMS 24.5.3  r54322 Released Oct  1, 2015 WEX-WEI x86 64bit/MS Windows 10/21/15 11:06:47 Page 2
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Include File Summary


   SEQ   GLOBAL TYPE      PARENT   LOCAL  FILENAME

     1        1 INPUT          0       0  C:\Users\robin\Google Drive\TU Delft\T
                                          hesis\GAMS\projdir\Optimal Power Flow\
                                          OPF.gms
     2       18 INCLUDE        1      18  .C:\Users\robin\Google Drive\TU Delft\
                                           Thesis\GAMS\projdir\Indices_OPF.inc
     3       40 INCLUDE        1      22  .C:\Users\robin\Google Drive\TU Delft\
                                           Thesis\GAMS\projdir\Resistive_Network
                                           _OPF.inc
     4       87 INCLUDE        1      26  .C:\Users\robin\Google Drive\TU Delft\
                                           Thesis\GAMS\projdir\CCsources_OPF.inc
     5      134 INCLUDE        1      30  .C:\Users\robin\Google Drive\TU Delft\
                                           Thesis\GAMS\projdir\CCloads_OPF.inc


COMPILATION TIME     =        0.000 SECONDS      3 MB  24.5.3 r54322 WEX-WEI
GAMS 24.5.3  r54322 Released Oct  1, 2015 WEX-WEI x86 64bit/MS Windows 10/21/15 11:06:47 Page 3
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Equation Listing    SOLVE OPF Using LP From line 270


---- AllCurrentSources  =E=  Sum of currents of all sources at node i

AllCurrentSources(n1)..  In(n1) - CCSources(n1,n4) =E= 0 ; (LHS = 0)
     
AllCurrentSources(n2)..  In(n2) - CCSources(n2,n6) =E= 0 ; (LHS = 0)
     
AllCurrentSources(n3)..  In(n3) =E= 5 ; (LHS = 0, INFES = 5 ****)
     
REMAINING 3 ENTRIES SKIPPED


---- BranchCurrent  =E=  Current in branch ij

BranchCurrent(n4,n5)..  Ibr(n4,n5) - V(n4) + V(n5) =E= 0 ; (LHS = 0)
     
BranchCurrent(n4,n6)..  Ibr(n4,n6) - V(n4) + V(n6) =E= 0 ; (LHS = 0)
     
BranchCurrent(n5,n4)..  Ibr(n5,n4) + V(n4) - V(n5) =E= 0 ; (LHS = 0)
     
REMAINING 3 ENTRIES SKIPPED


---- NodalCurrent  =E=  Nodal current equation

NodalCurrent(n1)..  In(n1) =E= 0 ; (LHS = 0)
     
NodalCurrent(n2)..  In(n2) =E= 0 ; (LHS = 0)
     
NodalCurrent(n3)..  In(n3) =E= 0 ; (LHS = 0)
     
REMAINING 3 ENTRIES SKIPPED


---- Equality  =E=  

Equality..  CCSources(n1,n4) + CCSources(n2,n6) + CCSources(n4,n1)
     
      + CCSources(n6,n2) =E= 0 ; (LHS = 0)
     

---- Costfunction  =E=  Cost function to be minimized

Costfunction..  - CCSources(n4,n1) - 6*CCSources(n6,n2) + cost =E= 0 ; (LHS = 0)
     
GAMS 24.5.3  r54322 Released Oct  1, 2015 WEX-WEI x86 64bit/MS Windows 10/21/15 11:06:47 Page 4
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Column Listing      SOLVE OPF Using LP From line 270


---- Ibr  Branch Current

Ibr(n4,n5)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       BranchCurrent(n4,n5)
       -1       NodalCurrent(n4)
        1       NodalCurrent(n5)

Ibr(n4,n6)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       BranchCurrent(n4,n6)
       -1       NodalCurrent(n4)
        1       NodalCurrent(n6)

Ibr(n5,n4)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       BranchCurrent(n5,n4)
        1       NodalCurrent(n4)
       -1       NodalCurrent(n5)

REMAINING 3 ENTRIES SKIPPED

---- In  Nodal Current

In(n1)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       AllCurrentSources(n1)
        1       NodalCurrent(n1)

In(n2)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       AllCurrentSources(n2)
        1       NodalCurrent(n2)

In(n3)
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       AllCurrentSources(n3)
        1       NodalCurrent(n3)

REMAINING 3 ENTRIES SKIPPED

---- V  Nodal Voltage

V(n4)
                (.LO, .L, .UP, .M = -200, 0, 200, 0)
       -1       BranchCurrent(n4,n5)
       -1       BranchCurrent(n4,n6)
        1       BranchCurrent(n5,n4)
        1       BranchCurrent(n6,n4)

V(n5)
                (.LO, .L, .UP, .M = -200, 0, 200, 0)
        1       BranchCurrent(n4,n5)
       -1       BranchCurrent(n5,n4)
       -1       BranchCurrent(n5,n6)
        1       BranchCurrent(n6,n5)

V(n6)
                (.LO, .L, .UP, .M = -200, 0, 200, 0)
        1       BranchCurrent(n4,n6)
        1       BranchCurrent(n5,n6)
       -1       BranchCurrent(n6,n4)
       -1       BranchCurrent(n6,n5)


---- CCSources  Constant Current Source

CCSources(n1,n4)
                (.LO, .L, .UP, .M = -9, 0, 9, 0)
       -1       AllCurrentSources(n1)
        1       Equality

CCSources(n2,n6)
                (.LO, .L, .UP, .M = -9, 0, 9, 0)
       -1       AllCurrentSources(n2)
        1       Equality

CCSources(n4,n1)
                (.LO, .L, .UP, .M = -9, 0, 9, 0)
       -1       AllCurrentSources(n4)
        1       Equality
       -1       Costfunction

REMAINING ENTRY SKIPPED

---- cost  

cost
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       Costfunction

GAMS 24.5.3  r54322 Released Oct  1, 2015 WEX-WEI x86 64bit/MS Windows 10/21/15 11:06:47 Page 5
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Model Statistics    SOLVE OPF Using LP From line 270


MODEL STATISTICS

BLOCKS OF EQUATIONS           5     SINGLE EQUATIONS           20
BLOCKS OF VARIABLES           5     SINGLE VARIABLES           20
NON ZERO ELEMENTS            53


GENERATION TIME      =        0.016 SECONDS      4 MB  24.5.3 r54322 WEX-WEI


EXECUTION TIME       =        0.016 SECONDS      4 MB  24.5.3 r54322 WEX-WEI
GAMS 24.5.3  r54322 Released Oct  1, 2015 WEX-WEI x86 64bit/MS Windows 10/21/15 11:06:47 Page 6
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE OPF Using LP From line 270


               S O L V E      S U M M A R Y

     MODEL   OPF                 OBJECTIVE  cost
     TYPE    LP                  DIRECTION  MINIMIZE
     SOLVER  CPLEX               FROM LINE  270

**** SOLVER STATUS     1 Normal Completion         
**** MODEL STATUS      4 Infeasible                
**** OBJECTIVE VALUE              -45.0000

 RESOURCE USAGE, LIMIT          0.094      1000.000
 ITERATION COUNT, LIMIT         5    2000000000

IBM ILOG CPLEX   24.5.3 r54322 Released Oct  1, 2015 WEI x86 64bit/MS Windows 
Cplex 12.6.2.0

Space for names approximately 0.00 Mb
Use option 'names no' to turn use of names off
LP status(3): infeasible
Cplex Time: 0.00sec (det. 0.00 ticks)
Rerunning with presolve turned off and solving with LPMETHOD=0
LP status(3): infeasible
Cplex Time: 0.00sec (det. 0.02 ticks)
Model has been proven infeasible.

---- EQU AllCurrentSources  Sum of currents of all sources at node i

      LOWER     LEVEL     UPPER    MARGINAL

n1      .         .         .        1.000      
n2      .         .         .        1.000      
n3     5.000     5.000     5.000      EPS       
n4      .         .         .         EPS       
n5    -5.000    -5.000    -5.000      EPS       
n6      .         .         .         EPS       

---- EQU BranchCurrent  Current in branch ij

         LOWER     LEVEL     UPPER    MARGINAL

n4.n5      .         .         .         EPS       
n4.n6      .         .         .         EPS       
n5.n4      .         .         .         EPS       
n5.n6      .         .         .         EPS       
n6.n4      .         .         .         EPS       
n6.n5      .         .         .         EPS       

---- EQU NodalCurrent  Nodal current equation

      LOWER     LEVEL     UPPER    MARGINAL

n1      .         .         .       -1.000      
n2      .         .         .       -1.000      
n3      .        5.000      .         .    INFES
n4      .       -9.000      .         .    INFES
n5      .        4.000      .         .    INFES
n6      .         .         .         EPS       

                       LOWER     LEVEL     UPPER    MARGINAL

---- EQU Equality        .         .         .        1.000      
---- EQU Costfunct~      .         .         .        1.000      

  Costfunction  Cost function to be minimized

---- VAR Ibr  Branch Current

         LOWER     LEVEL     UPPER    MARGINAL

n4.n5     -INF      4.500     +INF       .         
n4.n6     -INF      4.500     +INF       .         
n5.n4     -INF     -4.500     +INF       .         
n5.n6     -INF       .        +INF       .         
n6.n4     -INF     -4.500     +INF       .         
n6.n5     -INF       .        +INF       .         

---- VAR In  Nodal Current

      LOWER     LEVEL     UPPER    MARGINAL

n1     -INF       .        +INF       .         
n2     -INF       .        +INF       .         
n3     -INF      5.000     +INF       .         
n4     -INF      9.000     +INF       .         
n5     -INF     -5.000     +INF       .         
n6     -INF     -9.000     +INF       .         

---- VAR V  Nodal Voltage

      LOWER     LEVEL     UPPER    MARGINAL

n4  -200.000  -195.500   200.000      .         
n5  -200.000  -200.000   200.000      EPS       
n6  -200.000  -200.000   200.000      EPS       

---- VAR CCSources  Constant Current Source

         LOWER     LEVEL     UPPER    MARGINAL

n1.n4    -9.000      .        9.000      .         
n2.n6    -9.000      .        9.000      .         
n4.n1    -9.000     9.000     9.000      .         
n6.n2    -9.000    -9.000     9.000     5.000      

                       LOWER     LEVEL     UPPER    MARGINAL

---- VAR cost           -INF    -45.000     +INF       .         


**** REPORT SUMMARY :        0     NONOPT
                             3 INFEASIBLE (INFES)
                    SUM     18.000
                    MAX      9.000
                    MEAN     6.000
                             0  UNBOUNDED
GAMS 24.5.3  r54322 Released Oct  1, 2015 WEX-WEI x86 64bit/MS Windows 10/21/15 11:06:47 Page 7
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
E x e c u t i o n


----    273 PARAMETER R  

            n4          n5          n6

n4                   1.000       1.000
n5       1.000                   1.000
n6       1.000       1.000


----    273 VARIABLE V.L  Nodal Voltage

n4 -195.500,    n5 -200.000,    n6 -200.000


----    273 SET ij  lines

            n4          n5          n6

n4                     YES         YES
n5         YES                     YES
n6         YES         YES


----    273 SET CCs  constant current sources

            n1          n2          n4          n6

n1                                 YES
n2                                             YES
n4         YES
n6                     YES


----    273 SET CCl  constant current loads

            n3          n5

n3                     YES
n5         YES


----    273 VARIABLE In.L  Nodal Current

n3  5.000,    n4  9.000,    n5 -5.000,    n6 -9.000


----    273 VARIABLE Ibr.L  Branch Current

            n4          n5          n6

n4                   4.500       4.500
n5      -4.500
n6      -4.500


----    273 VARIABLE CCSources.L  Constant Current Source

            n1          n2

n4       9.000
n6                  -9.000


----    273 VARIABLE cost.L                =      -45.000  


EXECUTION TIME       =        0.000 SECONDS      3 MB  24.5.3 r54322 WEX-WEI


USER: Course License, Introduction to Decision Suppo G150929:0359AO-GEN
      TU Delft, Faculteit Elektrotechniek, Wiskunde en InformatiDC12029
      License for teaching and research at degree granting institutions


**** FILE SUMMARY

Input      C:\Users\robin\Google Drive\TU Delft\Thesis\GAMS\projdir\Optimal Powe
           r Flow\OPF.gms
Output     C:\Users\robin\Google Drive\TU Delft\Thesis\GAMS\projdir\OPF.lst
